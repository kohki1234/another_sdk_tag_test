<html>

<head>
    <script type="text/javascript">
    !function(t,e){if(void 0===e[t]){e[t]=function(){e[t].clients.push(this),this._init=[Array.prototype.slice.call(arguments)]},e[t].clients=[];for(var r=function(t){return function(){return this["_"+t]=this["_"+t]||[],this["_"+t].push(Array.prototype.slice.call(arguments)),this}},s=["addRecord","set","trackEvent","trackPageview","trackClicks","ready","setSignedMode","fetchUserSegments","fetchGlobalID","setAnonymousMode"],a=0;a<s.length;a++){var c=s[a];e[t].prototype[c]=r(c)}var n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src=("https:"===document.location.protocol?"https:":"http:")+"//cdn.treasuredata.com/sdk/1.7.1/td.min.js";var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(n,i)}}("Treasure",this);
        </script>

    <script>
        // Configure an instance for your database
        var td = new Treasure({
            host: 'in.treasuredata.com',
            writeKey: '10452/de7bec368253e78d34c4ff6c9d52145a32f117b9',
            database: 'kohki_test',
            startInSignedMode: true

        });
        // Enable cross-domain tracking

        var successCallback = function(globalId) {
            console.log(globalId)

        };

        var errorCallback = function(error) {
            console.log("ERROR CALL BACK")
        };

        td.setSignedMode();
        

        td.set('$global', 'td_global_id', 'td_global_id');

        // Track pageview information to a table
        td.trackPageview('new_sdk_test_2');

        td.fetchUserSegments({
            audienceToken: ['fe4796f3-eb0a-483c-b391-2ed076460353'],
            keys: {
                user_id : 'TEST02459259',
                td_country_name: 'Japan'
            }
        }, successCallback, errorCallback)

        var successCallback_global = function (td_global_id) {
            console.log(td_global_id)
        };

        var errorCallback_global = function (error) {
            console.log('failed')
        }

        td.fetchGlobalID(successCallback_global, errorCallback_global)


    </script>

    <!-- =======================================================
  Start https://cookieconsent.insites.com/ tag
  ======================================================= -->
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
    <script>
        window.addEventListener("load", function() {
            window.cookieconsent.initialise({
                "palette": {
                    "popup": {
                        "background": "#3c404d",
                        "text": "#d6d6d6"
                    },
                    "button": {
                        "background": "#8bed4f"
                    }
                },
                "type": "opt-out",
                "revokable": true,
                onStatusChange: function(status) {
                    this.hasConsented() ? td.setSignedMode() : td.setAnonymousMode();
                },
            })
        });
    </script>
</head>

<body>JavaSript SDK test page with Node JS server</body>

<button onclick=""></button>

</html>